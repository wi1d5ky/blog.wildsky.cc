<!doctype html> <html prefix='og: http://ogp.me/ns#'> <head> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50389098-1', 'auto');
  ga('send', 'pageview');
</script> <meta name=viewport content="width=device-width, initial-scale=1"> <meta charset=utf-8 /> <meta name=title content="在 Code::Blocks 開開心心 Unit Test | ws://wildsky.cc"/> <meta name=description content="最近軟體工程在教單元測試（Unit Test），可是因為老師是 C# 戰士， 所以我們學的就是用 Visual Studio 的內建測試來測 C#，但我又不寫 C#！！ 於是乎，這兩個禮拜就瘋狂..."/> <meta property="og:type" content=article /> <meta property="og:site_name" content="在 Code::Blocks 開開心心 Unit Test"/> <meta property="og:locale" content=zh_TW /> <meta property="og:url" content="http://blog.wildsky.cc/posts/unit-test-in-codeblocks/"/> <meta property="og:image" content="http://blog.wildsky.cc/images/wildsky_main_pic.jpg"/> <meta property="og:title" content="在 Code::Blocks 開開心心 Unit Test | ws://wildsky.cc"/> <meta property="og:description" content="最近軟體工程在教單元測試（Unit Test），可是因為老師是 C# 戰士， 所以我們學的就是用 Visual Studio 的內建測試來測 C#，但我又不寫 C#！！ 於是乎，這兩個禮拜就瘋狂..."/> <meta property="fb:app_id" content=1521058658143315 /> <meta property='article:author' content='https://www.facebook.com/wi1d5ky'/> <meta name="twitter:card" content=summary /> <meta name="twitter:site" content="@wildskyf"/> <meta name="twitter:title" content="在 Code::Blocks 開開心心 Unit Test | ws://wildsky.cc"/> <meta name="twitter:description" content="最近軟體工程在教單元測試（Unit Test），可是因為老師是 C# 戰士， 所以我們學的就是用 Visual Studio 的內建測試來測 C#，但我又不寫 C#！！ 於是乎，這兩個禮拜就瘋狂..."/> <meta name="twitter:image" content="http://blog.wildsky.cc/images/wildsky_main_pic.jpg"/> <title> 在 Code::Blocks 開開心心 Unit Test | ws://wildsky.cc </title> <link rel="shortcut icon" type="image/png" href="/favicon.png"/> <link rel=stylesheet href="/style.css" media=bogus> <link rel=stylesheet href="/syntax.css" media=bogus> <link rel=alternate type="application/atom+xml" title="Atom Feed" href="/feed.xml"/> <script>
        (function() {
          var d = document, s = d.createElement('script');
          s.src = 'https://wildsky.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script> </head> <body> <div class=container> <div id=site-header> <nav> <ul> <li><a href="/about/">About</a></li> <li><a href="/fedora/">Fedora</a></li> <li><a href="/subscribe/">Subscribe</a></li> <li><a href="/search/">Search</a></li> </ul> </nav> <header> <div class=site-title><a href="/">ws://wildsky.cc</a></div> <p class=slogan>風吹過什麼樣的地方，身上自然而然就會有那樣的氣息。</p> </header> </div> <div id=main role=main> <article> <div class=content> <h1>在 Code::Blocks 開開心心 Unit Test</h1> <p>最近軟體工程在教單元測試（Unit Test），可是因為老師是 C# 戰士， 所以我們學的就是用 Visual Studio 的內建測試來測 C#，但我又不寫 C#！！ 於是乎，這兩個禮拜就瘋狂地在網路上搜尋，但都沒有收穫（或是我太弱了看不懂QwQ）， 後來終於在 Facebook 看到 <a href="http://www.github.com/aigecko/">http://www.github.com/aigecko/</a>旁門左道之神 - 師大貓耳控</a> 學長的動態：</p> <blockquote> <p>專題好像愈改愈炸 效能更慘還多了BUG 於是把軟工的Google Test拿了出來用用看 先把專案的link和search path設定好</p> <p>然後define一個標籤讓main可以跑不同模式 可以只執行程式也可以只跑單元測試 不然BUG有夠難抓 就算有git可以幫忙倒帶還是很靠北</p> </blockquote> <p>其實他在抱怨什麼我完全沒看，但看到單元測試這四個字我就欣喜若狂， 立刻向他請教「如何在 Code:Blocks」上跑單元測試的方法， 因此這篇文章就誕生了！</p> <h2>正文</h2> <h4>下載 &amp; 建置 Gmock</h4> <p>首先，先去下載 Gmock 最新版：<a href="https://code.google.com/p/googlemock/downloads/list">https://code.google.com/p/googlemock/downloads/list</a> 然後把他解壓縮到桌面，開啟 Terminal，前往該目錄底下，輸入下面的指令</p> <p><code>./configure</code> 他會開始跑東西，跑完後輸入</p> <p><code>make</code> 如果沒有錯誤，那最最基本的步驟就完成了！</p> <h4>專案設定</h4> <p>開啟 code:blocks，新增一個新專案（姑且稱之為 runTest），接著到左邊的 icon 上按右鍵，選擇 Build options&#8230; ， 將位於跳出的視窗上方的 tab 切換到 Linker setting，進行如下的設定（注意相對位置）， 我是習慣將 Gmock 資料夾放在專案的上層目錄，所以相對路徑會這樣，你可以自行更動。</p> <p><a href="http://wildsky.cc/blog-images/2015-11-01-01-55-51-的螢幕擷圖-1024x576.png">Code:Blocks Linker setting</a></p> <p>接著，Tab 切換到 Search directories，加入下面的位置，一樣要注意相對目錄。</p> <p><a href="http://wildsky.cc/blog-images/2015-11-01-01-13-10-的螢幕擷圖-1024x576.png">Code:Blocks Search directories - Compiler</a></p> <p>Sub-tab 切換到 Linker 一樣進行設定。</p> <p><a href="http://wildsky.cc/blog-images/2015-11-01-01-13-12-的螢幕擷圖-1024x576.png">Code:Blocks Search directories - Linker</a></p> <p>這樣環境就差不多設定完成了！</p> <h4>跑第一次測試</h4> <p>新增一個 main.cpp 檔，內容輸入如下： &ldquo;`</p> <h1>include &lt;stdio.h&gt;</h1> <h1>define TEST_MODE 1</h1> <h1>if TEST_MODE==1</h1> <h1>include &quot;gmock/gmock.h&rdquo;</h1> <h1>include &ldquo;gtest/gtest.h&rdquo;</h1> <h1>include &ldquo;Test.h&rdquo;</h1> <h1>endif // TEST_MODE</h1> <h1>if TEST_MODE==1</h1> <p>int main(int argc,char **argv){ ::testing::InitGoogleTest(&amp;argc, argv); return RUN<em>ALL</em>TESTS();</p> <h1>else</h1> <p>int main(){</p> <h1>endif // TEST_MODE</h1> <p>printf(&ldquo;Run Test!\n&rdquo;); return 0; }</p> <h1>include &ldquo;gmock/gmock.h&rdquo;</h1> <h1>include &ldquo;gtest/gtest.h&rdquo;</h1> <p>class Happy : public ::testing::Test{}; TEST<em>F(Happy,UnitTest){ EXPECT</em>EQ(1,1); EXPECT_EQ(1,0); } &ldquo;`</p> <p>這時，按下 F9 就會跑測試了！！為了讓測試是真的有效，我就給了兩個最明顯的測試，1 == 1 以及 1 == 0，所以 run 出來的結果會有一個成功一個失敗，如下圖：</p> <p><a href="http://wildsky.cc/blog-images/2015-11-01-13-47-48-的螢幕擷圖.png">Running First Test</a></p> <p>這樣就成功跑測試了！如果要測自己寫的 class 的方法，就直接像一般的專案那樣，在 test.h 中 include 要測的檔案，然後在 EXPECT_EQ 中輸入該輸入東西， 因為我也是昨天才建起這個環境的，所以還需要一點時間來摸熟，如果想知道更多可以去翻翻 Gmock 的文件。</p> <p>話說有一點網路上都沒有提到：如果想要正常建置，只要在 main.cpp 裡面的第 2 行把 <code>#define TEST_MODE 1</code></p> <h2>後話</h2> <p>最近在讀〈學徒模式〉這本書，書中提到的「詢問身邊的專家」模式真的很好用 😀</p> <p>大家有空可以去買來讀讀。</p> <h2>相關連結</h2> <ul> <li>旁門左道之神 &#8211; 師大貓耳控：<a href="http://www.github.com/aigecko/">http://www.github.com/aigecko/</a></li> <li>gmock：<a href="https://code.google.com/p/googlemock/">https://code.google.com/p/googlemock/</a></li> <li>我的完整專案目錄：<a href="https://www.dropbox.com/s/6mnfw18cfemv0k4/runTest.zip?dl=1">https://www.dropbox.com/s/6mnfw18cfemv0k4/runTest.zip?dl=1</a></li> <li>學徒模式－優秀軟體開發者的養成之路：<a href="http://www.tenlong.com.tw/items/986276256X?item_id=338410">http://www.tenlong.com.tw/items/986276256X?item_id=338410</a></li> </ul> </div> </article> <div class=switch> <div class=pre> <a href="/posts/ubunu-installation-optimize/">《 上一頁</a> </div> ☺ <div class=next> <a href="/posts/mozilla-project/">下一頁 》</a> </div> </div> <div id=disqus_thread></div> <noscript>請啟用 JavaScript 以便開啟 <a href="https://disqus.com/?ref_noscript" rel=nofollow>Disqus</a> 的留言功能！</noscript> </div> </div> <footer> <a href="http://github.com/wildskyf">wildsky</a> <form action="https://www.paypal.com/cgi-bin/webscr" method=post target=_top class=footer-item> <input type=hidden name=cmd value=_s-xclick> <input type=hidden name=hosted_button_id value=92X2FP2T63MTN> <input type=submit border=0 name=submit value=Donate> <img alt="" border=0 src="https://www.paypalobjects.com/zh_TW/i/scr/pixel.gif" width=1 height=1> </form> </footer> <link rel=stylesheet href="/style.css"> <link rel=stylesheet href="/syntax.css"> </body> </html>