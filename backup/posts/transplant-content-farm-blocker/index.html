<!doctype html> <html prefix='og: http://ogp.me/ns#'> <head> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50389098-1', 'auto');
  ga('send', 'pageview');
</script> <meta name=viewport content="width=device-width, initial-scale=1"> <meta charset=utf-8 /> <meta name=title content="移植「封鎖內容農場」套件 | ws://wildsky.cc"/> <meta name=description content=" 最近一直在玩 Firefox 的擴充套件， 不過剛開始用來上手的專案都跟新分頁替換有關， 所以基本上架構大同小異。 前兩天在 chrome 上找到一個叫做「封鎖內容農場」的套件， 稍微找了..."/> <meta property="og:type" content=article /> <meta property="og:site_name" content="移植「封鎖內容農場」套件"/> <meta property="og:locale" content=zh_TW /> <meta property="og:url" content="http://blog.wildsky.cc/posts/transplant-content-farm-blocker/"/> <meta property="og:image" content="http://blog.wildsky.cc/images/wildsky_main_pic.jpg"/> <meta property="og:title" content="移植「封鎖內容農場」套件 | ws://wildsky.cc"/> <meta property="og:description" content=" 最近一直在玩 Firefox 的擴充套件， 不過剛開始用來上手的專案都跟新分頁替換有關， 所以基本上架構大同小異。 前兩天在 chrome 上找到一個叫做「封鎖內容農場」的套件， 稍微找了..."/> <meta property="fb:app_id" content=1521058658143315 /> <meta property='article:author' content='https://www.facebook.com/wi1d5ky'/> <meta name="twitter:card" content=summary /> <meta name="twitter:site" content="@wildskyf"/> <meta name="twitter:title" content="移植「封鎖內容農場」套件 | ws://wildsky.cc"/> <meta name="twitter:description" content=" 最近一直在玩 Firefox 的擴充套件， 不過剛開始用來上手的專案都跟新分頁替換有關， 所以基本上架構大同小異。 前兩天在 chrome 上找到一個叫做「封鎖內容農場」的套件， 稍微找了..."/> <meta name="twitter:image" content="http://blog.wildsky.cc/images/wildsky_main_pic.jpg"/> <title> 移植「封鎖內容農場」套件 | ws://wildsky.cc </title> <link rel="shortcut icon" type="image/png" href="/favicon.png"/> <link rel=stylesheet href="/style.css" media=bogus> <link rel=stylesheet href="/syntax.css" media=bogus> <link rel=alternate type="application/atom+xml" title="Atom Feed" href="/feed.xml"/> <script>
        (function() {
          var d = document, s = d.createElement('script');
          s.src = 'https://wildsky.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script> </head> <body> <div class=container> <div id=site-header> <nav> <ul> <li><a href="/about/">About</a></li> <li><a href="/fedora/">Fedora</a></li> <li><a href="/subscribe/">Subscribe</a></li> <li><a href="/search/">Search</a></li> </ul> </nav> <header> <div class=site-title><a href="/">ws://wildsky.cc</a></div> <p class=slogan>風吹過什麼樣的地方，身上自然而然就會有那樣的氣息。</p> </header> </div> <div id=main role=main> <article> <div class=content> <h1>移植「封鎖內容農場」套件</h1> <p><img src="http://wildsky.cc/blog-images/content farm blocker.png" alt="content farm screenshot"/></p> <p>最近一直在玩 Firefox 的擴充套件， 不過剛開始用來上手的專案都跟新分頁替換有關， 所以基本上架構大同小異。</p> <p>前兩天在 chrome 上找到一個叫做「封鎖內容農場」的套件， 稍微找了一下就找到他的 GitHub repo， 赫然發現 issue 裡面有人想要 firefox 的版本， 到 AMO 看了一下以後，真的沒有這類的套件。 剛好最近在玩火狐的 WebExtension 套件，趁這個機會來練習， 順便做點功德！</p> <p>（這邊開始簡略地講程式相關的事，不想看可以直接跳最後一段XD）</p> <p>移植的過程中主要處理幾件事情：require, chrome 變成 browser, 處理警告畫面的流程。</p> <h3>require</h3> <p>簡單地說就是，chrome 下可以像 node 專案那樣 <code>var a require(&#39;package&#39;);</code> 但 firefox 的 WebExtension 架構卻沒辦法做這種事， 所以我直接用 <code>&quot;background&quot; : { &quot;scripts&quot;: [] }</code> 把他們通通載進來， 只是不確定是 sync 還是 async，總之現階段可以用就是了。</p> <h3>chrome 變成 browser</h3> <p>其實不改的話好像還是可以跑，但就是想要把它改成正常的樣子（？） 最近在看「JavaScript 的優良部份」，書中提到這樣的一句話：</p> <blockquote> <p>偶爾很有用，偶爾會出錯的功能才是最可怕的！</p> </blockquote> <p>（有點小改但語意不變啦）所以還是要自律一下啊。</p> <h3>處理警告畫面的流程</h3> <p>其實我也不太確定原作者在 tabs.onUpdate 時才去 handle(tab) 是為什麼， 感覺直接在 beforeRequest 做掉應該就可以了，在 firefox 上用原作者的方法反而不會觸發 onUpdate 所以我就直接改成在 beforeRequest 判斷是內容農場後直接把 request 處理掉了。</p> <hr> <h2>功能</h2> <p>這個套件的宗旨其實很簡單， 就是希望大家不要再莫名其妙被驚呆了， 一直看到這一類的標題看得智商跟著一直降， 雖然可以裝 ublock 把廣告擋掉，但送流量給他就是讓人感覺不爽， 其他自訂黑名單白名單之類的功能面我就不說了，可以自己去裝裝看玩玩看</p> <ul> <li>原始碼在這裡： <a href="https://github.com/wildskyf/ihatecontentfarm">https://github.com/wildskyf/ihatecontentfarm</a></li> <li>AMO 在這裡（審核中）： <a href="https://addons.mozilla.org/zh-TW/firefox/addon/cfblocker/">https://addons.mozilla.org/zh-TW/firefox/addon/cfblocker/</a></li> <li>原專案在這裡： <a href="https://github.com/benlau/ihatecontentfarms">https://github.com/benlau/ihatecontentfarms</a></li> </ul> <p>還有不少東西可以調整，對這個套件有興趣的人歡迎開 issue 或是在下面留言， 不知道我上面在說什麼的人，如果是在用 Firefox 的話也可以幫忙測試抓抓 bug 啊</p> <p>下一個版本大概會修一下版面，順便 responsive 一下，支援一下 firefox on android。</p> </div> </article> <div class=switch> <div class=pre> <a href="/posts/disable-hot-corner-in-steam/">《 上一頁</a> </div> ☺ <div class=next> <a href="/posts/fedora-database/">下一頁 》</a> </div> </div> <div id=disqus_thread></div> <noscript>請啟用 JavaScript 以便開啟 <a href="https://disqus.com/?ref_noscript" rel=nofollow>Disqus</a> 的留言功能！</noscript> </div> </div> <footer> <a href="http://github.com/wildskyf">wildsky</a> <form action="https://www.paypal.com/cgi-bin/webscr" method=post target=_top class=footer-item> <input type=hidden name=cmd value=_s-xclick> <input type=hidden name=hosted_button_id value=92X2FP2T63MTN> <input type=submit border=0 name=submit value=Donate> <img alt="" border=0 src="https://www.paypalobjects.com/zh_TW/i/scr/pixel.gif" width=1 height=1> </form> </footer> <link rel=stylesheet href="/style.css"> <link rel=stylesheet href="/syntax.css"> </body> </html>